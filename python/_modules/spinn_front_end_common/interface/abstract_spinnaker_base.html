
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>spinn_front_end_common.interface.abstract_spinnaker_base &#8212; SpiNNFrontEndCommon 1!7.0.0-a1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinxdoc.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">SpiNNFrontEndCommon 1!7.0.0-a1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">spinn_front_end_common.interface.abstract_spinnaker_base</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for spinn_front_end_common.interface.abstract_spinnaker_base</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) 2016 The University of Manchester</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     https://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">main interface for the SpiNNaker tools</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">signal</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Condition</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">numpy_version</span>

<span class="kn">from</span> <span class="nn">spinn_utilities</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">spinn_utils_version</span>
<span class="kn">from</span> <span class="nn">spinn_utilities.config_holder</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">get_config_bool</span><span class="p">,</span> <span class="n">get_config_int</span><span class="p">,</span> <span class="n">get_config_str</span><span class="p">,</span> <span class="n">set_config</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">spinn_utilities.log</span> <span class="kn">import</span> <span class="n">FormatAdapter</span>

<span class="kn">from</span> <span class="nn">spinn_machine</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">spinn_machine_version</span>
<span class="kn">from</span> <span class="nn">spinn_machine</span> <span class="kn">import</span> <span class="n">CoreSubsets</span><span class="p">,</span> <span class="n">Machine</span>

<span class="kn">from</span> <span class="nn">spinnman</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">spinnman_version</span>
<span class="kn">from</span> <span class="nn">spinnman.exceptions</span> <span class="kn">import</span> <span class="n">SpiNNManCoresNotInStateException</span>
<span class="kn">from</span> <span class="nn">spinnman.model.cpu_infos</span> <span class="kn">import</span> <span class="n">CPUInfos</span>
<span class="kn">from</span> <span class="nn">spinnman.model.enums</span> <span class="kn">import</span> <span class="n">CPUState</span><span class="p">,</span> <span class="n">ExecutableType</span>

<span class="kn">from</span> <span class="nn">data_specification</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">data_spec_version</span>

<span class="kn">from</span> <span class="nn">spalloc_client</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">spalloc_version</span>

<span class="kn">from</span> <span class="nn">pacman</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">pacman_version</span>
<span class="kn">from</span> <span class="nn">pacman.exceptions</span> <span class="kn">import</span> <span class="n">PacmanPlaceException</span>
<span class="kn">from</span> <span class="nn">pacman.model.graphs.application</span> <span class="kn">import</span> <span class="n">ApplicationEdge</span>
<span class="kn">from</span> <span class="nn">pacman.model.graphs</span> <span class="kn">import</span> <span class="n">AbstractVirtual</span>
<span class="kn">from</span> <span class="nn">pacman.model.partitioner_splitters.splitter_reset</span> <span class="kn">import</span> <span class="n">splitter_reset</span>
<span class="kn">from</span> <span class="nn">pacman.model.placements</span> <span class="kn">import</span> <span class="n">Placements</span>
<span class="kn">from</span> <span class="nn">pacman.operations.fixed_route_router</span> <span class="kn">import</span> <span class="n">fixed_route_router</span>
<span class="kn">from</span> <span class="nn">pacman.operations.partition_algorithms</span> <span class="kn">import</span> <span class="n">splitter_partitioner</span>
<span class="kn">from</span> <span class="nn">pacman.operations.placer_algorithms</span> <span class="kn">import</span> <span class="n">place_application_graph</span>
<span class="kn">from</span> <span class="nn">pacman.operations.router_algorithms</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">basic_dijkstra_routing</span><span class="p">,</span> <span class="n">ner_route</span><span class="p">,</span> <span class="n">ner_route_traffic_aware</span><span class="p">,</span>
    <span class="n">route_application_graph</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pacman.operations.router_compressors</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">pair_compressor</span><span class="p">,</span> <span class="n">range_compressor</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pacman.operations.router_compressors.ordered_covering_router_compressor</span> \
    <span class="kn">import</span> <span class="nn">ordered_covering_compressor</span>
<span class="kn">from</span> <span class="nn">pacman.operations.routing_info_allocator_algorithms.</span>\
    <span class="n">zoned_routing_info_allocator</span> <span class="kn">import</span> <span class="p">(</span><span class="n">flexible_allocate</span><span class="p">,</span> <span class="n">global_allocate</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pacman.operations.routing_table_generators</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">basic_routing_table_generator</span><span class="p">,</span> <span class="n">merged_routing_table_generator</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pacman.operations.tag_allocator_algorithms</span> <span class="kn">import</span> <span class="n">basic_tag_allocator</span>

<span class="kn">from</span> <span class="nn">spinn_front_end_common</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">fec_version</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common</span> <span class="kn">import</span> <span class="n">common_model_binaries</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.abstract_models</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AbstractVertexWithEdgeToDependentVertices</span><span class="p">,</span>
    <span class="n">AbstractCanReset</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.data.fec_data_view</span> <span class="kn">import</span> <span class="n">FecDataView</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.interface.buffer_management</span> <span class="kn">import</span> <span class="n">BufferManager</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.interface.buffer_management.storage_objects</span> \
    <span class="kn">import</span> <span class="nn">BufferDatabase</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.interface.config_handler</span> <span class="kn">import</span> <span class="n">ConfigHandler</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.interface.interface_functions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">application_finisher</span><span class="p">,</span> <span class="n">application_runner</span><span class="p">,</span>
    <span class="n">chip_io_buf_clearer</span><span class="p">,</span> <span class="n">chip_io_buf_extractor</span><span class="p">,</span>
    <span class="n">chip_provenance_updater</span><span class="p">,</span> <span class="n">chip_runtime_updater</span><span class="p">,</span> <span class="n">compute_energy_used</span><span class="p">,</span>
    <span class="n">create_notification_protocol</span><span class="p">,</span> <span class="n">database_interface</span><span class="p">,</span>
    <span class="n">reload_dsg_regions</span><span class="p">,</span> <span class="n">energy_provenance_reporter</span><span class="p">,</span>
    <span class="n">execute_application_data_specs</span><span class="p">,</span> <span class="n">execute_system_data_specs</span><span class="p">,</span>
    <span class="n">graph_binary_gatherer</span><span class="p">,</span> <span class="n">graph_data_specification_writer</span><span class="p">,</span>
    <span class="n">graph_provenance_gatherer</span><span class="p">,</span>
    <span class="n">host_based_bit_field_router_compressor</span><span class="p">,</span> <span class="n">hbp_allocator</span><span class="p">,</span>
    <span class="n">insert_chip_power_monitors_to_graphs</span><span class="p">,</span>
    <span class="n">insert_extra_monitor_vertices_to_graphs</span><span class="p">,</span> <span class="n">split_lpg_vertices</span><span class="p">,</span>
    <span class="n">load_app_images</span><span class="p">,</span> <span class="n">load_fixed_routes</span><span class="p">,</span> <span class="n">load_sys_images</span><span class="p">,</span>
    <span class="n">local_tdma_builder</span><span class="p">,</span> <span class="n">locate_executable_start_type</span><span class="p">,</span>
    <span class="n">machine_generator</span><span class="p">,</span>
    <span class="n">placements_provenance_gatherer</span><span class="p">,</span> <span class="n">profile_data_gatherer</span><span class="p">,</span>
    <span class="n">read_routing_tables_from_machine</span><span class="p">,</span> <span class="n">router_provenance_gatherer</span><span class="p">,</span>
    <span class="n">routing_setup</span><span class="p">,</span> <span class="n">routing_table_loader</span><span class="p">,</span>
    <span class="n">sdram_outgoing_partition_allocator</span><span class="p">,</span> <span class="n">spalloc_allocator</span><span class="p">,</span>
    <span class="n">system_multicast_routing_generator</span><span class="p">,</span>
    <span class="n">tags_loader</span><span class="p">,</span> <span class="n">virtual_machine_generator</span><span class="p">,</span> <span class="n">add_command_senders</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.interface.interface_functions.</span>\
    <span class="n">machine_bit_field_router_compressor</span> <span class="kn">import</span> <span class="p">(</span>
        <span class="n">machine_bit_field_ordered_covering_compressor</span><span class="p">,</span>
        <span class="n">machine_bit_field_pair_router_compressor</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.interface.interface_functions.</span>\
    <span class="n">host_no_bitfield_router_compression</span> <span class="kn">import</span> <span class="p">(</span>
        <span class="n">ordered_covering_compression</span><span class="p">,</span> <span class="n">pair_compression</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.interface.provenance</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">FecTimer</span><span class="p">,</span> <span class="n">GlobalProvenance</span><span class="p">,</span> <span class="n">TimerCategory</span><span class="p">,</span> <span class="n">TimerWork</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.interface.splitter_selectors</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">splitter_selector</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.interface.java_caller</span> <span class="kn">import</span> <span class="n">JavaCaller</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.utilities.exceptions</span> <span class="kn">import</span> <span class="n">ConfigurationException</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.utilities.report_functions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">bitfield_compressor_report</span><span class="p">,</span> <span class="n">board_chip_report</span><span class="p">,</span> <span class="n">EnergyReport</span><span class="p">,</span>
    <span class="n">fixed_route_from_machine_report</span><span class="p">,</span> <span class="n">memory_map_on_host_report</span><span class="p">,</span>
    <span class="n">memory_map_on_host_chip_report</span><span class="p">,</span> <span class="n">network_specification</span><span class="p">,</span>
    <span class="n">router_collision_potential_report</span><span class="p">,</span>
    <span class="n">routing_table_from_machine_report</span><span class="p">,</span> <span class="n">tags_from_machine_report</span><span class="p">,</span>
    <span class="n">write_json_machine</span><span class="p">,</span> <span class="n">write_json_placements</span><span class="p">,</span>
    <span class="n">write_json_routing_tables</span><span class="p">,</span> <span class="n">drift_report</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.utilities.iobuf_extractor</span> <span class="kn">import</span> <span class="n">IOBufExtractor</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.utility_models</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DataSpeedUpPacketGatherMachineVertex</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">spinn_front_end_common.utilities.report_functions.reports</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">generate_comparison_router_report</span><span class="p">,</span> <span class="n">partitioner_report</span><span class="p">,</span>
    <span class="n">placer_reports_with_application_graph</span><span class="p">,</span>
    <span class="n">router_compressed_summary_report</span><span class="p">,</span> <span class="n">routing_info_report</span><span class="p">,</span>
    <span class="n">router_report_from_compressed_router_tables</span><span class="p">,</span>
    <span class="n">router_report_from_paths</span><span class="p">,</span>
    <span class="n">router_report_from_router_tables</span><span class="p">,</span> <span class="n">router_summary_report</span><span class="p">,</span>
    <span class="n">sdram_usage_report_per_chip</span><span class="p">,</span>
    <span class="n">tag_allocator_report</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">scipy_version</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">scipy_version</span> <span class="o">=</span> <span class="s2">&quot;scipy not installed&quot;</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">FormatAdapter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">))</span>


<div class="viewcode-block" id="AbstractSpinnakerBase"><a class="viewcode-back" href="../../../spinn_front_end_common.interface.html#spinn_front_end_common.interface.abstract_spinnaker_base.AbstractSpinnakerBase">[docs]</a><span class="k">class</span> <span class="nc">AbstractSpinnakerBase</span><span class="p">(</span><span class="n">ConfigHandler</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main interface into the tools logic flow.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pylint: disable=broad-except</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c1"># The IP-address of the SpiNNaker machine</span>

        <span class="c1"># Condition object used for waiting for stop</span>
        <span class="c1"># Set during init and the used but never new object</span>
        <span class="s2">&quot;_state_condition&quot;</span><span class="p">,</span>

        <span class="c1"># Set when run_until_complete is specified by the user</span>
        <span class="s2">&quot;_run_until_complete&quot;</span><span class="p">,</span>

        <span class="c1">#</span>
        <span class="s2">&quot;_raise_keyboard_interrupt&quot;</span><span class="p">,</span>

        <span class="c1"># A dict of live packet gather params to Application LGP vertices</span>
        <span class="s2">&quot;_lpg_vertices&quot;</span><span class="p">,</span>

        <span class="c1"># Used in exception handling and control c</span>
        <span class="s2">&quot;_last_except_hook&quot;</span><span class="p">,</span>

        <span class="c1"># All beyond this point new for no extractor</span>
        <span class="c1"># The data is not new but now it is held direct and not via inputs</span>

        <span class="c1"># Flag to say is compressed routing tables are on machine</span>
        <span class="c1"># TODO remove this when the data change only algorithms are done</span>
        <span class="s2">&quot;_multicast_routes_loaded&quot;</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_writer_cls</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param int n_chips_required:</span>
<span class="sd">            Overrides the number of chips to allocate from spalloc_client</span>
<span class="sd">        :param int n_boards_required:</span>
<span class="sd">            Overrides the number of boards to allocate from spalloc_client</span>
<span class="sd">        :param FecDataWriter data_writer_cls:</span>
<span class="sd">            The Global data writer class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=too-many-arguments</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data_writer_cls</span><span class="p">)</span>

        <span class="n">FecTimer</span><span class="o">.</span><span class="n">start_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">WAITING</span><span class="p">)</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">start_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">SETTING_UP</span><span class="p">)</span>

        <span class="c1"># output locations of binaries to be searched for end user info</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Will search these locations for binaries: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_executable_finder</span><span class="p">()</span><span class="o">.</span><span class="n">binary_paths</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># store for Live Packet Gatherers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lpg_vertices</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># holder for timing and running related values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_until_complete</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_state_condition</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">()</span>

        <span class="c1"># folders</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_up_report_specifics</span><span class="p">()</span>

        <span class="c1"># Setup for signal handling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_raise_keyboard_interrupt</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_create_version_provenance</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_last_except_hook</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">excepthook</span>

        <span class="n">FecTimer</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">register_binary_search_path</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">common_model_binaries</span><span class="o">.</span><span class="vm">__file__</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_machine_generator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_machine</span><span class="p">)</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">end_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">SETTING_UP</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_hard_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This clears all data that if no longer valid after a hard reset</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">has_transceiver</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_transceiver</span><span class="p">()</span><span class="o">.</span><span class="n">stop_application</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_app_id</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__close_allocation_controller</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">hard_reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_machine_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_setup_java_caller</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Java&quot;</span><span class="p">,</span> <span class="s2">&quot;use_java&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_java_caller</span><span class="p">(</span><span class="n">JavaCaller</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">__signal_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_signal</span><span class="p">,</span> <span class="n">_frame</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles closing down of script via keyboard interrupt</span>

<span class="sd">        :param _signal: the signal received (ignored)</span>
<span class="sd">        :param _frame: frame executed in (ignored)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If we are to raise the keyboard interrupt, do so</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_raise_keyboard_interrupt</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyboardInterrupt</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;User has cancelled simulation&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">__bearer_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: The OIDC bearer token</span>
<span class="sd">        :rtype: str or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Try using Jupyter if we have the right variables</span>
        <span class="n">jupyter_token</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;JUPYTERHUB_API_TOKEN&quot;</span><span class="p">)</span>
        <span class="n">jupyter_ip</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;JUPYTERHUB_SERVICE_HOST&quot;</span><span class="p">)</span>
        <span class="n">jupyter_port</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;JUPYTERHUB_SERVICE_PORT&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">jupyter_token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">jupyter_ip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span>
                <span class="n">jupyter_port</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">jupyter_url</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;http://</span><span class="si">{</span><span class="n">jupyter_ip</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">jupyter_port</span><span class="si">}</span><span class="s2">/services/&quot;</span>
                           <span class="s2">&quot;access-token-service/access-token&quot;</span><span class="p">)</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Token </span><span class="si">{</span><span class="n">jupyter_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">jupyter_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;access_token&#39;</span><span class="p">)</span>

        <span class="c1"># Try a simple environment variable, or None if that doesn&#39;t exist</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;OIDC_BEARER_TOKEN&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="AbstractSpinnakerBase.exception_handler"><a class="viewcode-back" href="../../../spinn_front_end_common.interface.html#spinn_front_end_common.interface.abstract_spinnaker_base.AbstractSpinnakerBase.exception_handler">[docs]</a>    <span class="k">def</span> <span class="nf">exception_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback_obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handler of exceptions.</span>

<span class="sd">        :param type exc_type: the type of exception received</span>
<span class="sd">        :param Exception value: the value of the exception</span>
<span class="sd">        :param traceback traceback_obj: the trace back stuff</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Shutdown on exception&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_except_hook</span><span class="p">(</span><span class="n">exc_type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">traceback_obj</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_should_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the simulation should run.</span>

<span class="sd">        Will warn the user if there is no need to run</span>

<span class="sd">        :return: True if and only if one of the graphs has vertices in it</span>
<span class="sd">        :raises ConfigurationException: If the current state does not</span>
<span class="sd">            support a new run call</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_n_vertices</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Your graph has no vertices in it. &quot;</span>
            <span class="s2">&quot;Therefore the run call will exit immediately.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="AbstractSpinnakerBase.run_until_complete"><a class="viewcode-back" href="../../../spinn_front_end_common.interface.html#spinn_front_end_common.interface.abstract_spinnaker_base.AbstractSpinnakerBase.run_until_complete">[docs]</a>    <span class="k">def</span> <span class="nf">run_until_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run a simulation until it completes.</span>

<span class="sd">        :param int n_steps:</span>
<span class="sd">            If not `None`, this specifies that the simulation should be</span>
<span class="sd">            requested to run for the given number of steps.  The host will</span>
<span class="sd">            still wait until the simulation itself says it has completed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">start_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">RUN_OTHER</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run_until_complete</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run</span><span class="p">(</span><span class="n">n_steps</span><span class="p">,</span> <span class="n">sync_time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">end_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">RUN_OTHER</span><span class="p">)</span></div>

<div class="viewcode-block" id="AbstractSpinnakerBase.run"><a class="viewcode-back" href="../../../spinn_front_end_common.interface.html#spinn_front_end_common.interface.abstract_spinnaker_base.AbstractSpinnakerBase.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_time</span><span class="p">,</span> <span class="n">sync_time</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run a simulation for a fixed amount of time.</span>

<span class="sd">        :param int run_time: the run duration in milliseconds.</span>
<span class="sd">        :param float sync_time:</span>
<span class="sd">            If not 0, this specifies that the simulation should pause after</span>
<span class="sd">            this duration.  The continue_simulation() method must then be</span>
<span class="sd">            called for the simulation to continue.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">start_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">RUN_OTHER</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_until_complete</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;run after run_until_complete&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_run</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span> <span class="n">sync_time</span><span class="p">)</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">end_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">RUN_OTHER</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__timesteps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_in_ms</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a number of timesteps for a given time in milliseconds.</span>

<span class="sd">        :return: The number of timesteps</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">time_step_ms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_simulation_time_step_ms</span><span class="p">()</span>
        <span class="n">n_time_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">time_in_ms</span> <span class="o">/</span> <span class="n">time_step_ms</span><span class="p">))</span>
        <span class="n">calc_time</span> <span class="o">=</span> <span class="n">n_time_steps</span> <span class="o">*</span> <span class="n">time_step_ms</span>

        <span class="c1"># Allow for minor float errors</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">time_in_ms</span> <span class="o">-</span> <span class="n">calc_time</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.00001</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Time of </span><span class="si">{}</span><span class="s2">ms &quot;</span>
                <span class="s2">&quot;is not a multiple of the machine time step of </span><span class="si">{}</span><span class="s2">ms &quot;</span>
                <span class="s2">&quot;and has therefore been rounded up to </span><span class="si">{}</span><span class="s2">ms&quot;</span><span class="p">,</span>
                <span class="n">time_in_ms</span><span class="p">,</span> <span class="n">time_step_ms</span><span class="p">,</span> <span class="n">calc_time</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n_time_steps</span>

    <span class="k">def</span> <span class="nf">_calc_run_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates n_machine_time_steps and total_run_time based on run_time</span>
<span class="sd">        and machine_time_step.</span>

<span class="sd">        This method rounds the run up to the next timestep as discussed in</span>
<span class="sd">        https://github.com/SpiNNakerManchester/sPyNNaker/issues/149</span>

<span class="sd">        If run_time is `None` (run forever) both values will be `None`</span>

<span class="sd">        :param run_time: time user requested to run for in milliseconds</span>
<span class="sd">        :type run_time: float or None</span>
<span class="sd">        :return: n_machine_time_steps as a whole int and</span>
<span class="sd">            total_run_time in milliseconds</span>
<span class="sd">        :rtype: tuple(int,float) or tuple(None,None)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">run_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="n">n_machine_time_steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timesteps</span><span class="p">(</span><span class="n">run_time</span><span class="p">)</span>
        <span class="n">total_run_timesteps</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_current_run_timesteps</span><span class="p">()</span> <span class="o">+</span>
            <span class="n">n_machine_time_steps</span><span class="p">)</span>
        <span class="n">total_run_time</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">total_run_timesteps</span> <span class="o">*</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_hardware_time_step_ms</span><span class="p">())</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Simulating for </span><span class="si">{</span><span class="n">n_machine_time_steps</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_simulation_time_step_ms</span><span class="p">()</span><span class="si">}</span><span class="s2"> ms timesteps &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;using a hardware timestep of &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_hardware_time_step_us</span><span class="p">()</span><span class="si">}</span><span class="s2"> us&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n_machine_time_steps</span><span class="p">,</span> <span class="n">total_run_time</span>

    <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_time</span><span class="p">,</span> <span class="n">sync_time</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">start_run</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__run</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span> <span class="n">sync_time</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">finish_run</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># if in debug mode, do not shut down machine</span>
            <span class="k">if</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Mode&quot;</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;Debug&quot;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">stop_e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error </span><span class="si">{</span><span class="n">stop_e</span><span class="si">}</span><span class="s2"> when attempting to stop&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">shut_down</span><span class="p">()</span>
            <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">__run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_time</span><span class="p">,</span> <span class="n">sync_time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The main internal run function.</span>

<span class="sd">        :param int run_time: the run duration in milliseconds.</span>
<span class="sd">        :param int sync_time:</span>
<span class="sd">            the time in milliseconds between synchronisations, or 0 to disable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_should_run</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="c1"># verify that we can keep doing auto pause and resume</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_ran_ever</span><span class="p">():</span>
            <span class="n">can_keep_running</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span>
                <span class="n">executable_type</span><span class="o">.</span><span class="n">supports_auto_pause_and_resume</span>
                <span class="k">for</span> <span class="n">executable_type</span> <span class="ow">in</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_executable_types</span><span class="p">())</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">can_keep_running</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                    <span class="s2">&quot;Only binaries that use the simulation interface can be&quot;</span>
                    <span class="s2">&quot; run more than once&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_config</span><span class="p">(</span><span class="n">run_time</span><span class="p">)</span>

        <span class="c1"># Install the Control-C handler</span>
        <span class="c1"># pylint: disable=protected-access</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">current_thread</span><span class="p">(),</span> <span class="n">threading</span><span class="o">.</span><span class="n">_MainThread</span><span class="p">):</span>
            <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__signal_handler</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_raise_keyboard_interrupt</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">excepthook</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_except_hook</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting execution process&quot;</span><span class="p">)</span>

        <span class="n">n_machine_time_steps</span><span class="p">,</span> <span class="n">total_run_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calc_run_time</span><span class="p">(</span><span class="n">run_time</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">FecDataView</span><span class="o">.</span><span class="n">has_allocation_controller</span><span class="p">():</span>
            <span class="n">FecDataView</span><span class="o">.</span><span class="n">get_allocation_controller</span><span class="p">()</span><span class="o">.</span><span class="n">extend_allocation</span><span class="p">(</span>
                <span class="n">total_run_time</span><span class="p">)</span>

        <span class="n">n_sync_steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__timesteps</span><span class="p">(</span><span class="n">sync_time</span><span class="p">)</span>

        <span class="c1"># If we have never run before, or the graph has changed,</span>
        <span class="c1"># start by performing mapping</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_requires_mapping</span><span class="p">()</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_ran_last</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;The network cannot be changed between runs without&quot;</span>
                <span class="s2">&quot; resetting&quot;</span><span class="p">)</span>

        <span class="c1"># If we have reset and the graph has changed, stop any running</span>
        <span class="c1"># application</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_requires_data_generation</span><span class="p">()</span> <span class="ow">and</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">has_transceiver</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_transceiver</span><span class="p">()</span><span class="o">.</span><span class="n">stop_application</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_app_id</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">reset_sync_signal</span><span class="p">()</span>
        <span class="c1"># build the graphs to modify with system requirements</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_requires_mapping</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_soft_reset</span><span class="p">():</span>
                <span class="c1"># wipe out stuff associated with past mapping</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_hard_reset</span><span class="p">()</span>
            <span class="n">FecTimer</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_add_dependent_verts_and_edges_for_application_graph</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Buffers&quot;</span><span class="p">,</span> <span class="s2">&quot;use_auto_pause_and_resume&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_plan_n_timesteps</span><span class="p">(</span><span class="n">get_config_int</span><span class="p">(</span>
                    <span class="s2">&quot;Buffers&quot;</span><span class="p">,</span> <span class="s2">&quot;minimum_auto_time_steps&quot;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_plan_n_timesteps</span><span class="p">(</span><span class="n">n_machine_time_steps</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_do_mapping</span><span class="p">(</span><span class="n">total_run_time</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_ran_last</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_do_write_metadata</span><span class="p">()</span>

        <span class="c1"># Check if anything has per-timestep SDRAM usage</span>
        <span class="n">is_per_timestep_sdram</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_per_timestep_sdram</span><span class="p">()</span>

        <span class="c1"># Disable auto pause and resume if the binary can&#39;t do it</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;virtual_board&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">executable_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_executable_types</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">executable_type</span><span class="o">.</span><span class="n">supports_auto_pause_and_resume</span><span class="p">:</span>
                    <span class="n">set_config</span><span class="p">(</span>
                        <span class="s2">&quot;Buffers&quot;</span><span class="p">,</span> <span class="s2">&quot;use_auto_pause_and_resume&quot;</span><span class="p">,</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>

        <span class="c1"># Work out the maximum run duration given all recordings</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">has_max_run_time_steps</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_max_run_time_steps</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_deduce_data_n_timesteps</span><span class="p">())</span>

        <span class="c1"># Work out an array of timesteps to perform</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Buffers&quot;</span><span class="p">,</span> <span class="s2">&quot;use_auto_pause_and_resume&quot;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="ow">not</span> <span class="n">is_per_timestep_sdram</span><span class="p">):</span>

            <span class="c1"># Runs should only be in units of max_run_time_steps at most</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">is_per_timestep_sdram</span> <span class="ow">and</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_max_run_time_steps</span><span class="p">()</span>
                        <span class="o">&lt;</span> <span class="n">n_machine_time_steps</span> <span class="ow">or</span>
                        <span class="n">n_machine_time_steps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
                    <span class="s2">&quot;The SDRAM required by one or more vertices is based on &quot;</span>
                    <span class="s2">&quot;the run time, so the run time is limited to &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_max_run_time_steps</span><span class="p">()</span><span class="si">}</span><span class="s2"> time steps&quot;</span><span class="p">)</span>

            <span class="n">steps</span> <span class="o">=</span> <span class="p">[</span><span class="n">n_machine_time_steps</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">run_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="c1"># With auto pause and resume, any time step is possible but run</span>
            <span class="c1"># time more than the first will guarantee that run will be called</span>
            <span class="c1"># more than once</span>
            <span class="n">steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_steps</span><span class="p">(</span><span class="n">n_machine_time_steps</span><span class="p">)</span>

        <span class="c1"># requires data_generation includes never run and requires_mapping</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_requires_data_generation</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_do_load</span><span class="p">()</span>

        <span class="c1"># Run for each of the given steps</span>
        <span class="k">if</span> <span class="n">run_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Running for </span><span class="si">{}</span><span class="s2"> steps for a total of </span><span class="si">{}</span><span class="s2">ms&quot;</span><span class="p">,</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">steps</span><span class="p">),</span> <span class="n">run_time</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
                <span class="n">run_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">next_run_step</span><span class="p">()</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Run </span><span class="si">{</span><span class="n">run_step</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_do_run</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">n_sync_steps</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">clear_run_steps</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">run_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_until_complete</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Running until complete&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_do_run</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_sync_steps</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="ow">not</span> <span class="n">get_config_bool</span><span class="p">(</span>
                <span class="s2">&quot;Buffers&quot;</span><span class="p">,</span> <span class="s2">&quot;use_auto_pause_and_resume&quot;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="ow">not</span> <span class="n">is_per_timestep_sdram</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Running forever&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_do_run</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_sync_steps</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Waiting for stop request&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_condition</span><span class="p">:</span>
                <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_no_stop_requested</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_state_condition</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Running forever in steps of </span><span class="si">{}</span><span class="s2">ms&quot;</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_max_run_time_steps</span><span class="p">())</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_no_stop_requested</span><span class="p">():</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Run </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">next_run_step</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_do_run</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_max_run_time_steps</span><span class="p">(),</span> <span class="n">n_sync_steps</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">clear_run_steps</span><span class="p">()</span>

        <span class="c1"># Indicate that the signal handler needs to act</span>
        <span class="c1"># pylint: disable=protected-access</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">current_thread</span><span class="p">(),</span> <span class="n">threading</span><span class="o">.</span><span class="n">_MainThread</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_raise_keyboard_interrupt</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_except_hook</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">excepthook</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">excepthook</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exception_handler</span>

    <span class="k">def</span> <span class="nf">_is_per_timestep_sdram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">placement</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">iterate_placemements</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">placement</span><span class="o">.</span><span class="n">vertex</span><span class="o">.</span><span class="n">sdram_required</span><span class="o">.</span><span class="n">per_timestep</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_add_commands_to_command_sender</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_placements</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the VirtualMachineGenerator if required.</span>

<span class="sd">        May set then &quot;machine&quot; value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Command Sender Adder&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="n">all_command_senders</span> <span class="o">=</span> <span class="n">add_command_senders</span><span class="p">(</span><span class="n">system_placements</span><span class="p">)</span>
            <span class="c1"># add the edges from the command senders to the dependent vertices</span>
            <span class="k">for</span> <span class="n">command_sender</span> <span class="ow">in</span> <span class="n">all_command_senders</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">command_sender</span><span class="p">)</span>
                <span class="n">edges</span><span class="p">,</span> <span class="n">partition_ids</span> <span class="o">=</span> <span class="n">command_sender</span><span class="o">.</span><span class="n">edges_and_partitions</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">edge</span><span class="p">,</span> <span class="n">partition_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">partition_ids</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">edge</span><span class="p">,</span> <span class="n">partition_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_dependent_verts_and_edges_for_application_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># cache vertices to allow insertion during iteration</span>
        <span class="n">vertices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_vertices_by_type</span><span class="p">(</span>
                <span class="n">AbstractVertexWithEdgeToDependentVertices</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">vertices</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dependant_vertex</span> <span class="ow">in</span> <span class="n">vertex</span><span class="o">.</span><span class="n">dependent_vertices</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">vertex</span><span class="o">.</span><span class="n">addedToGraph</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">(</span><span class="n">dependant_vertex</span><span class="p">)</span>
                    <span class="n">edge_partition_ids</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span>\
                        <span class="n">edge_partition_identifiers_for_dependent_vertex</span><span class="p">(</span>
                            <span class="n">dependant_vertex</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">edge_identifier</span> <span class="ow">in</span> <span class="n">edge_partition_ids</span><span class="p">:</span>
                        <span class="n">dependant_edge</span> <span class="o">=</span> <span class="n">ApplicationEdge</span><span class="p">(</span>
                            <span class="n">pre_vertex</span><span class="o">=</span><span class="n">vertex</span><span class="p">,</span> <span class="n">post_vertex</span><span class="o">=</span><span class="n">dependant_vertex</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span>
                            <span class="n">dependant_edge</span><span class="p">,</span> <span class="n">edge_identifier</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_deduce_data_n_timesteps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Operates the auto pause and resume functionality by figuring out</span>
<span class="sd">        how many timer ticks a simulation can run before SDRAM runs out,</span>
<span class="sd">        and breaks simulation into chunks of that long.</span>

<span class="sd">        :return: max time a simulation can run.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Go through the placements and find how much SDRAM is used</span>
        <span class="c1"># on each chip</span>
        <span class="n">usage_by_chip</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">place</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">iterate_placemements</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">place</span><span class="o">.</span><span class="n">vertex</span><span class="p">,</span> <span class="n">AbstractVirtual</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="n">sdram</span> <span class="o">=</span> <span class="n">place</span><span class="o">.</span><span class="n">vertex</span><span class="o">.</span><span class="n">sdram_required</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">place</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">place</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">usage_by_chip</span><span class="p">:</span>
                <span class="n">usage_by_chip</span><span class="p">[</span><span class="n">place</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">place</span><span class="o">.</span><span class="n">y</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sdram</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">usage_by_chip</span><span class="p">[</span><span class="n">place</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">place</span><span class="o">.</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">sdram</span>

        <span class="c1"># Go through the chips and divide up the remaining SDRAM, finding</span>
        <span class="c1"># the minimum number of machine timesteps to assign</span>
        <span class="n">max_time_steps</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">sdram</span> <span class="ow">in</span> <span class="n">usage_by_chip</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_chip_at</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">sdram</span><span class="o">.</span><span class="n">size</span>
            <span class="k">if</span> <span class="n">sdram</span><span class="o">.</span><span class="n">fixed</span> <span class="o">&gt;</span> <span class="n">size</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">PacmanPlaceException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Too much SDRAM has been allocated on chip </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">sdram</span><span class="o">.</span><span class="n">fixed</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sdram</span><span class="o">.</span><span class="n">per_timestep</span><span class="p">:</span>
                <span class="n">max_this_chip</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">size</span> <span class="o">-</span> <span class="n">sdram</span><span class="o">.</span><span class="n">fixed</span><span class="p">)</span> <span class="o">//</span> <span class="n">sdram</span><span class="o">.</span><span class="n">per_timestep</span><span class="p">)</span>
                <span class="n">max_time_steps</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_time_steps</span><span class="p">,</span> <span class="n">max_this_chip</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">max_time_steps</span>

    <span class="k">def</span> <span class="nf">_generate_steps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates the list of &quot;timer&quot; runs. These are usually in terms of</span>
<span class="sd">        time steps, but need not be.</span>

<span class="sd">        :param int n_steps: the total runtime in machine time steps</span>
<span class="sd">        :return: list of time step lengths</span>
<span class="sd">        :rtype: list(int)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">n_steps</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">n_steps_per_segment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_max_run_time_steps</span><span class="p">()</span>
        <span class="n">n_full_iterations</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">n_steps</span> <span class="o">/</span> <span class="n">n_steps_per_segment</span><span class="p">))</span>
        <span class="n">left_over_steps</span> <span class="o">=</span> <span class="n">n_steps</span> <span class="o">-</span> <span class="n">n_full_iterations</span> <span class="o">*</span> <span class="n">n_steps_per_segment</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">n_steps_per_segment</span><span class="p">)]</span> <span class="o">*</span> <span class="n">n_full_iterations</span>
        <span class="k">if</span> <span class="n">left_over_steps</span><span class="p">:</span>
            <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">left_over_steps</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">steps</span>

    <span class="k">def</span> <span class="nf">_execute_get_virtual_machine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the VirtualMachineGenerator if required.</span>

<span class="sd">        May set then &quot;machine&quot; value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Virtual machine generator&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_machine</span><span class="p">(</span><span class="n">virtual_machine_generator</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_ipaddress</span><span class="p">(</span><span class="s2">&quot;virtual&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_execute_allocator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total_run_time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the SpallocAllocator or HBPAllocator if required.</span>

<span class="sd">        :param total_run_time: The total run time to request</span>
<span class="sd">        :type total_run_time: int or None</span>
<span class="sd">        :return: machine name, machine version, BMP details (if any),</span>
<span class="sd">            reset on startup flag, auto-detect BMP, SCAMP connection details,</span>
<span class="sd">            boot port, allocation controller</span>
<span class="sd">        :rtype: tuple(str, int, object, bool, bool, object, object,</span>
<span class="sd">            MachineAllocationController)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">has_machine</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;spalloc_server&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;SpallocAllocator&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">spalloc_allocator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__bearer_token</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;remote_spinnaker_url&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;HBPAllocator&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
                <span class="c1"># TODO: Would passing the bearer token to this ever make sense?</span>
                <span class="k">return</span> <span class="n">hbp_allocator</span><span class="p">(</span><span class="n">total_run_time</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_execute_machine_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">allocator_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the MachineGenerator if required.</span>

<span class="sd">        May set the &quot;machine&quot; value if not already set</span>

<span class="sd">        :param allocator_data: `None` or</span>
<span class="sd">            (machine name, machine version, BMP details (if any),</span>
<span class="sd">            reset on startup flag, auto-detect BMP, SCAMP connection details,</span>
<span class="sd">            boot port, allocation controller)</span>
<span class="sd">        :type allocator_data: None or</span>
<span class="sd">            tuple(str, int, object, bool, bool, object, object,</span>
<span class="sd">            MachineAllocationController)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">has_machine</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="n">machine_name</span> <span class="o">=</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;machine_name&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">machine_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_ipaddress</span><span class="p">(</span><span class="n">machine_name</span><span class="p">)</span>
            <span class="n">bmp_details</span> <span class="o">=</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;bmp_names&quot;</span><span class="p">)</span>
            <span class="n">auto_detect_bmp</span> <span class="o">=</span> <span class="n">get_config_bool</span><span class="p">(</span>
                <span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;auto_detect_bmp&quot;</span><span class="p">)</span>
            <span class="n">scamp_connection_data</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">reset_machine</span> <span class="o">=</span> <span class="n">get_config_bool</span><span class="p">(</span>
                <span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;reset_machine_on_startup&quot;</span><span class="p">)</span>
            <span class="n">board_version</span> <span class="o">=</span> <span class="n">get_config_int</span><span class="p">(</span>
                <span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;version&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">allocator_data</span><span class="p">:</span>
            <span class="p">(</span><span class="n">ipaddress</span><span class="p">,</span> <span class="n">board_version</span><span class="p">,</span> <span class="n">bmp_details</span><span class="p">,</span>
             <span class="n">reset_machine</span><span class="p">,</span> <span class="n">auto_detect_bmp</span><span class="p">,</span> <span class="n">scamp_connection_data</span><span class="p">,</span>
             <span class="n">machine_allocation_controller</span><span class="p">)</span> <span class="o">=</span> <span class="n">allocator_data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_ipaddress</span><span class="p">(</span><span class="n">ipaddress</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_allocation_controller</span><span class="p">(</span>
                <span class="n">machine_allocation_controller</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Machine generator&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">GET_MACHINE</span><span class="p">):</span>
            <span class="n">machine</span><span class="p">,</span> <span class="n">transceiver</span> <span class="o">=</span> <span class="n">machine_generator</span><span class="p">(</span>
                <span class="n">bmp_details</span><span class="p">,</span> <span class="n">board_version</span><span class="p">,</span>
                <span class="n">auto_detect_bmp</span><span class="p">,</span> <span class="n">scamp_connection_data</span><span class="p">,</span> <span class="n">reset_machine</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_transceiver</span><span class="p">(</span><span class="n">transceiver</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_machine</span><span class="p">(</span><span class="n">machine</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_known_machine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total_run_time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Python machine description object.</span>

<span class="sd">        :param float total_run_time: The total run time to request</span>
<span class="sd">        :rtype: ~spinn_machine.Machine</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">has_machine</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;virtual_board&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_execute_get_virtual_machine</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">allocator_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_allocator</span><span class="p">(</span><span class="n">total_run_time</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_execute_machine_generator</span><span class="p">(</span><span class="n">allocator_data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_machine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The factory method to get a machine.</span>

<span class="sd">        :rtype: ~spinn_machine.Machine</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">start_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">GET_MACHINE</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_user_mode</span><span class="p">()</span> <span class="ow">and</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_soft_reset</span><span class="p">():</span>
            <span class="c1"># Make the reset hard</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Calling Get machine after a reset force a hard reset and &quot;</span>
                <span class="s2">&quot;therefore generate a new machine&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hard_reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_get_known_machine</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">has_machine</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
                <span class="s2">&quot;Not enough information provided to supply a machine&quot;</span><span class="p">)</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">end_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">GET_MACHINE</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_version_provenance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add the version information to the provenance data at the start.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">GlobalProvenance</span><span class="p">()</span> <span class="k">as</span> <span class="n">db</span><span class="p">:</span>
            <span class="n">db</span><span class="o">.</span><span class="n">insert_version</span><span class="p">(</span><span class="s2">&quot;spinn_utilities_version&quot;</span><span class="p">,</span> <span class="n">spinn_utils_version</span><span class="p">)</span>
            <span class="n">db</span><span class="o">.</span><span class="n">insert_version</span><span class="p">(</span><span class="s2">&quot;spinn_machine_version&quot;</span><span class="p">,</span> <span class="n">spinn_machine_version</span><span class="p">)</span>
            <span class="n">db</span><span class="o">.</span><span class="n">insert_version</span><span class="p">(</span><span class="s2">&quot;spalloc_version&quot;</span><span class="p">,</span> <span class="n">spalloc_version</span><span class="p">)</span>
            <span class="n">db</span><span class="o">.</span><span class="n">insert_version</span><span class="p">(</span><span class="s2">&quot;spinnman_version&quot;</span><span class="p">,</span> <span class="n">spinnman_version</span><span class="p">)</span>
            <span class="n">db</span><span class="o">.</span><span class="n">insert_version</span><span class="p">(</span><span class="s2">&quot;pacman_version&quot;</span><span class="p">,</span> <span class="n">pacman_version</span><span class="p">)</span>
            <span class="n">db</span><span class="o">.</span><span class="n">insert_version</span><span class="p">(</span><span class="s2">&quot;data_specification_version&quot;</span><span class="p">,</span> <span class="n">data_spec_version</span><span class="p">)</span>
            <span class="n">db</span><span class="o">.</span><span class="n">insert_version</span><span class="p">(</span><span class="s2">&quot;front_end_common_version&quot;</span><span class="p">,</span> <span class="n">fec_version</span><span class="p">)</span>
            <span class="n">db</span><span class="o">.</span><span class="n">insert_version</span><span class="p">(</span><span class="s2">&quot;numpy_version&quot;</span><span class="p">,</span> <span class="n">numpy_version</span><span class="p">)</span>
            <span class="n">db</span><span class="o">.</span><span class="n">insert_version</span><span class="p">(</span><span class="s2">&quot;scipy_version&quot;</span><span class="p">,</span> <span class="n">scipy_version</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_do_extra_mapping_algorithms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows overriding classes to add algorithms.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_json_machine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs WriteJsonMachine if required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Json machine&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_json_machine&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">write_json_machine</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_report_network_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the Network Specification report is requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Network Specification report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_network_specification_report&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">network_specification</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_split_lpg_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_placements</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the SplitLPGVertices if required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Split Live Gather Vertices&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="n">split_lpg_vertices</span><span class="p">(</span><span class="n">system_placements</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_report_board_chip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the BoardChipReport is requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Board chip report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_board_chip_report&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">board_chip_report</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">FecDataView</span><span class="o">.</span><span class="n">has_allocation_controller</span><span class="p">():</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">FecDataView</span><span class="o">.</span><span class="n">get_run_dir_path</span><span class="p">(),</span> <span class="s2">&quot;machine_allocation.rpt&quot;</span><span class="p">)</span>
                <span class="n">FecDataView</span><span class="o">.</span><span class="n">get_allocation_controller</span><span class="p">()</span><span class="o">.</span><span class="n">make_report</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_execute_splitter_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the splitter_reset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Splitter reset&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="n">splitter_reset</span><span class="p">()</span>

    <span class="c1"># Overriden by spynaker to choose an extended algorithm</span>
    <span class="k">def</span> <span class="nf">_execute_splitter_selector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the SplitterSelector.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Splitter selector&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="n">splitter_selector</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_delay_support_adder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stub to allow sPyNNaker to add delay supports.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="c1"># Overriden by spynaker to choose a different algorithm</span>
    <span class="k">def</span> <span class="nf">_execute_splitter_partitioner</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the SplitterPartitioner if required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_n_vertices</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Splitter partitioner&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_n_chips_in_graph</span><span class="p">(</span><span class="n">splitter_partitioner</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_execute_insert_chip_power_monitors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_placements</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run, time and log the InsertChipPowerMonitorsToGraphs if required.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Insert chip power monitors&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_energy_report&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">insert_chip_power_monitors_to_graphs</span><span class="p">(</span><span class="n">system_placements</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_execute_insert_extra_monitor_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_placements</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run, time and log the InsertExtraMonitorVerticesToGraphs if required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Insert extra monitor vertices&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfgs_false</span><span class="p">(</span>
                    <span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;enable_advanced_monitor_support&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;enable_reinjection&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="c1"># inserter checks for None app graph not an empty one</span>
        <span class="n">gather_map</span><span class="p">,</span> <span class="n">monitor_map</span> <span class="o">=</span> <span class="n">insert_extra_monitor_vertices_to_graphs</span><span class="p">(</span>
            <span class="n">system_placements</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_gatherer_map</span><span class="p">(</span><span class="n">gather_map</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_monitor_map</span><span class="p">(</span><span class="n">monitor_map</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_report_partitioner</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write, times and logs the partitioner_report if needed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Partitioner report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_partitioner_reports&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">partitioner_report</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_local_tdma_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs times and logs the LocalTDMABuilder.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Local TDMA builder&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="n">local_tdma_builder</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_application_placer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_placements</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the Application Placer.</span>

<span class="sd">        Sets the &quot;placements&quot; data</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration placer value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Application Placer&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_placements</span><span class="p">(</span><span class="n">place_application_graph</span><span class="p">(</span>
                <span class="n">system_placements</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_do_placer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_placements</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs one of the placers.</span>

<span class="sd">        Sets the &quot;placements&quot; data</span>

<span class="sd">        Which placer is run depends on the configuration placer value</span>

<span class="sd">        This method is the entry point for adding a new Placer</span>

<span class="sd">        :raise ConfigurationException:</span>
<span class="sd">            if the configuration place value is unexpected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Mapping&quot;</span><span class="p">,</span> <span class="s2">&quot;placer&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;ApplicationPlacer&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_application_placer</span><span class="p">(</span><span class="n">system_placements</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
                <span class="s2">&quot;Only a single algorithm is supported for placer&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unexpected cfg setting placer: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_do_write_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Do the various functions to write metadata to the SQLite files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Record vertex labels to database&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">BufferDatabase</span><span class="p">()</span> <span class="k">as</span> <span class="n">db</span><span class="p">:</span>
                <span class="n">db</span><span class="o">.</span><span class="n">store_vertex_labels</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_system_multicast_routing_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the SystemMulticastRoutingGenerator if required.</span>

<span class="sd">        May sets the data &quot;data_in_multicast_routing_tables&quot;,</span>
<span class="sd">        &quot;data_in_multicast_key_to_chip_map&quot; and</span>
<span class="sd">        &quot;system_multicast_router_timeout_keys&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;System multicast routing generator&quot;</span><span class="p">,</span>
                <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfgs_false</span><span class="p">(</span>
                    <span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;enable_advanced_monitor_support&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;enable_reinjection&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">system_multicast_routing_generator</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_system_multicast_routing_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_execute_fixed_route_router</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the FixedRouteRouter if required.</span>

<span class="sd">        May set the &quot;fixed_routes&quot; data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Fixed route router&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;enable_advanced_monitor_support&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_fixed_routes</span><span class="p">(</span><span class="n">fixed_route_router</span><span class="p">(</span>
                <span class="n">DataSpeedUpPacketGatherMachineVertex</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_report_placements_with_application_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes, times and logs the application graph placer report if</span>
<span class="sd">        requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_n_vertices</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Placements wth application graph report&quot;</span><span class="p">,</span>
                <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_application_graph_placer_report&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">placer_reports_with_application_graph</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_json_placements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Does, times and logs the writing of placements as JSON if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Json placements&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_json_placements&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">write_json_placements</span><span class="p">()</span>
            <span class="c1"># Output ignored as never used</span>

    <span class="k">def</span> <span class="nf">_execute_ner_route_traffic_aware</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the NerRouteTrafficAware.</span>

<span class="sd">        Sets the &quot;routing_table_by_partition&quot; data if called</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration router value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Ner route traffic aware&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_routing_table_by_partition</span><span class="p">(</span>
                <span class="n">ner_route_traffic_aware</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_execute_ner_route</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the NerRoute.</span>

<span class="sd">        Sets the &quot;routing_table_by_partition&quot; data</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration router value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Ner route&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_routing_table_by_partition</span><span class="p">(</span><span class="n">ner_route</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_execute_basic_dijkstra_routing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the BasicDijkstraRouting.</span>

<span class="sd">        Sets the &quot;routing_table_by_partition&quot; data if called</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration router value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Basic dijkstra routing&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_routing_table_by_partition</span><span class="p">(</span>
                <span class="n">basic_dijkstra_routing</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_execute_application_router</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the ApplicationRouter.</span>

<span class="sd">        Sets the &quot;routing_table_by_partition&quot; data if called</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration router value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Application Router&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_routing_table_by_partition</span><span class="p">(</span>
                <span class="n">route_application_graph</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_do_routing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs one of the routers.</span>

<span class="sd">        Sets the &quot;routing_table_by_partition&quot; data</span>

<span class="sd">        Which router is run depends on the configuration router value</span>

<span class="sd">        This method is the entry point for adding a new Router</span>

<span class="sd">        :raise ConfigurationException:</span>
<span class="sd">            if the configuration router value is unexpected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Mapping&quot;</span><span class="p">,</span> <span class="s2">&quot;router&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;BasicDijkstraRouting&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_basic_dijkstra_routing</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;NerRoute&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_ner_route</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;NerRouteTrafficAware&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_ner_route_traffic_aware</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;ApplicationRouter&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_application_router</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
                <span class="s2">&quot;Only a single algorithm is supported for router&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unexpected cfg setting router: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_execute_basic_tag_allocator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the Tag Allocator.</span>

<span class="sd">        Sets the &quot;tag&quot; data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Basic tag allocator&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_tags</span><span class="p">(</span>
                <span class="n">basic_tag_allocator</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_report_tag_allocations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write, times and logs the tag allocator report if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Tag allocator report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_tag_allocation_reports&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">tag_allocator_report</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_global_allocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extra_allocations</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the Global Zoned Routing Info Allocator.</span>

<span class="sd">        Sets &quot;routing_info&quot; is called</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration</span>
<span class="sd">            info_allocator value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Global allocate&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_routing_infos</span><span class="p">(</span>
                <span class="n">global_allocate</span><span class="p">(</span><span class="n">extra_allocations</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_execute_flexible_allocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extra_allocations</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the Zoned Routing Info Allocator.</span>

<span class="sd">        Sets &quot;routing_info&quot; is called</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration</span>
<span class="sd">            info_allocator value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Zoned routing info allocator&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_routing_infos</span><span class="p">(</span>
                <span class="n">flexible_allocate</span><span class="p">(</span><span class="n">extra_allocations</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_do_info_allocator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs one of the info allocators.</span>

<span class="sd">        Sets the &quot;routing_info&quot; data</span>

<span class="sd">        Which allocator is run depends on the configuration info_allocator</span>
<span class="sd">        value.</span>

<span class="sd">        This method is the entry point for adding a new Info Allocator</span>

<span class="sd">        :raise ConfigurationException:</span>
<span class="sd">            if the configuration info_allocator value is unexpected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Mapping&quot;</span><span class="p">,</span> <span class="s2">&quot;info_allocator&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;GlobalZonedRoutingInfoAllocator&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_global_allocate</span><span class="p">([])</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;ZonedRoutingInfoAllocator&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_flexible_allocate</span><span class="p">([])</span>
        <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
                <span class="s2">&quot;Only a single algorithm is supported for info_allocator&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unexpected cfg setting info_allocator: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_report_router_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes, times and logs the router info report if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Router info report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_router_info_report&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">routing_info_report</span><span class="p">([])</span>

    <span class="k">def</span> <span class="nf">_execute_basic_routing_table_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the Routing Table Generator.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Currently no other Routing Table Generator supported.</span>
<span class="sd">            To add an additional Generator copy the pattern of do_placer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Basic routing table generator&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_uncompressed</span><span class="p">(</span><span class="n">basic_routing_table_generator</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_execute_merged_routing_table_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the Routing Table Generator.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Currently no other Routing Table Generator supported.</span>
<span class="sd">            To add an additional Generator copy the pattern of do_placer</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Merged routing table generator&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_uncompressed</span><span class="p">(</span>
                <span class="n">merged_routing_table_generator</span><span class="p">())</span>

        <span class="c1"># TODO Nuke ZonedRoutingTableGenerator</span>

    <span class="k">def</span> <span class="nf">_do_routing_table_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs one of the routing table generators.</span>

<span class="sd">        Sets the &quot;routing_info&quot; data</span>

<span class="sd">        Which allocator is run depends on the configuration&#39;s</span>
<span class="sd">        `routing_table_generator` value.</span>

<span class="sd">        This method is the entry point for adding a new routing table</span>
<span class="sd">        generator.</span>

<span class="sd">        :raise ConfigurationException:</span>
<span class="sd">            if the configuration&#39;s `routing_table_generator` value is</span>
<span class="sd">            unexpected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Mapping&quot;</span><span class="p">,</span> <span class="s2">&quot;routing_table_generator&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;BasicRoutingTableGenerator&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_basic_routing_table_generator</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;MergedRoutingTableGenerator&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_merged_routing_table_generator</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
                <span class="s2">&quot;Only a single algorithm is supported for&quot;</span>
                <span class="s2">&quot; routing_table_generator&quot;</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unexpected cfg setting routing_table_generator: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_report_routers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write, times and logs the router report if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Router report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_router_reports&quot;</span><span class="p">):</span>
                <span class="k">return</span>
        <span class="n">router_report_from_paths</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_report_router_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write, times and logs the router summary report if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Router summary report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_router_summary_report&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">router_summary_report</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_json_routing_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write, time and log the routing tables as JSON if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Json routing tables&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_json_routing_tables&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">write_json_routing_tables</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_uncompressed</span><span class="p">())</span>
            <span class="c1"># Output ignored as never used</span>

    <span class="k">def</span> <span class="nf">_report_router_collision_potential</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write, time and log the router collision report.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Router collision potential report&quot;</span><span class="p">,</span>
                <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_router_collision_potential_report&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">router_collision_potential_report</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_report_drift</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write, time and log the inter-board timer drift.</span>

<span class="sd">        :param bool start: Is this the start or the end</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Drift report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">start</span> <span class="ow">and</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_drift_report_start&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">start</span> <span class="ow">and</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_drift_report_end&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">drift_report</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_locate_executable_start_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs LocateExecutableStartType if required.</span>

<span class="sd">        May set the executable_types data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Locate executable start type&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_executable_types</span><span class="p">(</span>
                <span class="n">locate_executable_start_type</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_execute_buffer_manager_creator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run, times and logs the buffer manager creator if required.</span>

<span class="sd">        May set the buffer_manager data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">has_buffer_manager</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Buffer manager creator&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_buffer_manager</span><span class="p">(</span><span class="n">BufferManager</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_execute_sdram_outgoing_partition_allocator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the SDRAMOutgoingPartitionAllocator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;SDRAM outgoing partition allocator&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="n">sdram_outgoing_partition_allocator</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_control_sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">do_sync</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Control synchronization on board.</span>

<span class="sd">        :param bool do_sync: Whether to enable synchronization</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Control Sync&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_transceiver</span><span class="p">()</span><span class="o">.</span><span class="n">control_sync</span><span class="p">(</span><span class="n">do_sync</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_do_mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">total_run_time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs all the algorithms in the mapping stage.</span>

<span class="sd">        :param float total_run_time:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">start_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">MAPPING</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_setup_java_caller</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_extra_mapping_algorithms</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_report_network_specification</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_splitter_reset</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_splitter_selector</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_delay_support_adder</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_splitter_partitioner</span><span class="p">()</span>
        <span class="n">allocator_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_allocator</span><span class="p">(</span><span class="n">total_run_time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_machine_generator</span><span class="p">(</span><span class="n">allocator_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_machine</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_report_board_chip</span><span class="p">()</span>

        <span class="n">system_placements</span> <span class="o">=</span> <span class="n">Placements</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_commands_to_command_sender</span><span class="p">(</span><span class="n">system_placements</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_split_lpg_vertices</span><span class="p">(</span><span class="n">system_placements</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_insert_chip_power_monitors</span><span class="p">(</span><span class="n">system_placements</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_insert_extra_monitor_vertices</span><span class="p">(</span><span class="n">system_placements</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_report_partitioner</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_local_tdma_builder</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_placer</span><span class="p">(</span><span class="n">system_placements</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_report_placements_with_application_graph</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_placements</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_system_multicast_routing_generator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_fixed_route_router</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_routing</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_basic_tag_allocator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_report_tag_allocations</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_do_info_allocator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_report_router_info</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_routing_table_generator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_report_uncompressed_routing_table</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_report_routers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_report_router_summary</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_json_routing_tables</span><span class="p">()</span>
        <span class="c1"># self._report_router_collision_potential()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_locate_executable_start_type</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_buffer_manager_creator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_sdram_outgoing_partition_allocator</span><span class="p">()</span>

        <span class="n">FecTimer</span><span class="o">.</span><span class="n">end_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">MAPPING</span><span class="p">)</span>

    <span class="c1"># Overridden by spy which adds placement_order</span>
    <span class="k">def</span> <span class="nf">_execute_graph_data_specification_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times, and logs the GraphDataSpecificationWriter.</span>

<span class="sd">        Sets the dsg_targets data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Graph data specification writer&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_dsg_targets</span><span class="p">(</span>
                <span class="n">graph_data_specification_writer</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_do_data_generation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, Times and logs the data generation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># set up timing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_graph_data_specification_writer</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_routing_setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the RoutingSetup if required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Routing setup&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">LOADING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="c1"># Only needs the x and y of chips with routing tables</span>
            <span class="n">routing_setup</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_graph_binary_gatherer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the GraphBinaryGatherer if required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Graph binary gatherer&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_executable_targets</span><span class="p">(</span>
                    <span class="n">graph_binary_gatherer</span><span class="p">())</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;virtual_board&quot;</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s2">&quot;Ignoring exectable not found as using virtual&quot;</span><span class="p">)</span>
                    <span class="n">timer</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;exectable not found and virtual board&quot;</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">_execute_host_bitfield_compressor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the HostBasedBitFieldRouterCompressor</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration compressor or</span>
<span class="sd">            virtual_compressor value</span>

<span class="sd">        :return: Compressed routing tables</span>
<span class="sd">        :rtype: ~pacman.model.routing_tables.MulticastRoutingTables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Host based bitfield router compressor&quot;</span><span class="p">,</span>
                <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">compressed</span> <span class="o">=</span> <span class="n">host_based_bit_field_router_compressor</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">compressed</span>

    <span class="k">def</span> <span class="nf">_execute_machine_bitfield_ordered_covering_compressor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the MachineBitFieldOrderedCoveringCompressor.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration compressor or</span>
<span class="sd">            virtual_compressor value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Machine bitfield ordered covering compressor&quot;</span><span class="p">,</span>
                <span class="n">TimerWork</span><span class="o">.</span><span class="n">COMPRESSING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">machine_bit_field_ordered_covering_compressor</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_execute_machine_bitfield_pair_compressor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the MachineBitFieldPairRouterCompressor.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration compressor or</span>
<span class="sd">            virtual_compressor value</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
               <span class="s2">&quot;Machine bitfield pair router compressor&quot;</span><span class="p">,</span>
                <span class="n">TimerWork</span><span class="o">.</span><span class="n">COMPRESSING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">machine_bit_field_pair_router_compressor</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_execute_ordered_covering_compressor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the OrderedCoveringCompressor.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration compressor or</span>
<span class="sd">            virtual_compressor value</span>

<span class="sd">        :return: Compressed routing tables</span>
<span class="sd">        :rtype: ~pacman.model.routing_tables.MulticastRoutingTables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Ordered covering compressor&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">precompressed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_precompressed</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compression_skipable</span><span class="p">(</span><span class="n">precompressed</span><span class="p">):</span>
                <span class="n">timer</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="s2">&quot;Tables already small enough&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">precompressed</span>
            <span class="n">compressed</span> <span class="o">=</span> <span class="n">ordered_covering_compressor</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">compressed</span>

    <span class="k">def</span> <span class="nf">_execute_ordered_covering_compression</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the ordered covering compressor on machine.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration compressor or</span>
<span class="sd">            virtual_compressor value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Ordered covering compressor&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">COMPRESSING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[]</span>
            <span class="n">precompressed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_precompressed</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compression_skipable</span><span class="p">(</span><span class="n">precompressed</span><span class="p">):</span>
                <span class="n">timer</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="s2">&quot;Tables already small enough&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="n">precompressed</span>
            <span class="n">ordered_covering_compression</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_execute_pair_compressor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the PairCompressor.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration compressor or</span>
<span class="sd">            virtual_compressor value</span>

<span class="sd">        :return: Compressed routing table</span>
<span class="sd">        :rtype: ~pacman.model.routing_tables.MulticastRoutingTables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Pair compressor&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="n">precompressed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_precompressed</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compression_skipable</span><span class="p">(</span><span class="n">precompressed</span><span class="p">):</span>
                <span class="n">timer</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="s2">&quot;Tables already small enough&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">precompressed</span>
            <span class="n">compressed</span> <span class="o">=</span> <span class="n">pair_compressor</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">compressed</span>

    <span class="k">def</span> <span class="nf">_execute_pair_compression</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the pair compressor on machine.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration compressor or</span>
<span class="sd">            virtual_compressor value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Pair on chip router compression&quot;</span><span class="p">,</span>
                      <span class="n">TimerWork</span><span class="o">.</span><span class="n">COMPRESSING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">precompressed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_precompressed</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compression_skipable</span><span class="p">(</span><span class="n">precompressed</span><span class="p">):</span>
                <span class="n">timer</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="s2">&quot;Tables already small enough&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">return</span> <span class="n">precompressed</span>
            <span class="n">pair_compression</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_execute_pair_unordered_compressor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the CheckedUnorderedPairCompressor.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Calling of this method is based on the configuration compressor or</span>
<span class="sd">            virtual_compressor value</span>

<span class="sd">        :return: compressed routing tables</span>
<span class="sd">        :rtype: ~pacman.model.routing_tables.MulticastRoutingTables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Pair unordered compressor&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">precompressed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_precompressed</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compression_skipable</span><span class="p">(</span><span class="n">precompressed</span><span class="p">):</span>
                <span class="n">timer</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="s2">&quot;Tables already small enough&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">precompressed</span>
            <span class="n">compressed</span> <span class="o">=</span> <span class="n">pair_compressor</span><span class="p">(</span><span class="n">ordered</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">compressed</span>

    <span class="k">def</span> <span class="nf">_compressor_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;virtual_board&quot;</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Mapping&quot;</span><span class="p">,</span> <span class="s2">&quot;virtual_compressor&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;As no virtual_compressor specified &quot;</span>
                            <span class="s2">&quot;using compressor setting&quot;</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Mapping&quot;</span><span class="p">,</span> <span class="s2">&quot;compressor&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Mapping&quot;</span><span class="p">,</span> <span class="s2">&quot;compressor&quot;</span><span class="p">)</span>
        <span class="n">pre_compress</span> <span class="o">=</span> <span class="s2">&quot;BitField&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">name</span>
        <span class="k">return</span> <span class="n">name</span><span class="p">,</span> <span class="n">pre_compress</span>

    <span class="k">def</span> <span class="nf">_compression_skipable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tables</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">get_config_bool</span><span class="p">(</span>
                <span class="s2">&quot;Mapping&quot;</span><span class="p">,</span> <span class="s2">&quot;router_table_compress_as_far_as_possible&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">tables</span><span class="o">.</span><span class="n">max_number_of_entries</span> <span class="o">&lt;=</span> <span class="n">Machine</span><span class="o">.</span><span class="n">ROUTER_ENTRIES</span>

    <span class="k">def</span> <span class="nf">_execute_pre_compression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pre_compress</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pre_compress</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">get_config_str</span><span class="p">(</span><span class="s2">&quot;Mapping&quot;</span><span class="p">,</span> <span class="s2">&quot;precompressor&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_precompressed</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_uncompressed</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Ranged&quot;</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Ranged Compressor&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compression_skipable</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_uncompressed</span><span class="p">()):</span>
                        <span class="n">timer</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="s2">&quot;Tables already small enough&quot;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_precompressed</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_uncompressed</span><span class="p">())</span>
                        <span class="k">return</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_precompressed</span><span class="p">(</span>
                        <span class="n">range_compressor</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unexpected cfg setting precompressor: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_precompressed</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_uncompressed</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_do_early_compression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls a compressor based on the name provided.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This method is the entry point for adding a new compressor that</span>
<span class="sd">             can or must run early.</span>

<span class="sd">        :param str name: Name of a compressor</span>
<span class="sd">        :return: CompressedRoutingTables (likely to be `None)`,</span>
<span class="sd">            RouterCompressorProvenanceItems (may be an empty list)</span>
<span class="sd">        :rtype: tuple(~pacman.model.routing_tables.MulticastRoutingTables or</span>
<span class="sd">            None, list(ProvenanceDataItem))</span>
<span class="sd">        :raise ConfigurationException: if the name is not expected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;MachineBitFieldOrderedCoveringCompressor&quot;</span><span class="p">:</span>
            <span class="k">return</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_execute_machine_bitfield_ordered_covering_compressor</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;MachineBitFieldPairRouterCompressor&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_machine_bitfield_pair_compressor</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;OrderedCoveringCompressor&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_ordered_covering_compressor</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;OrderedCoveringOnChipRouterCompression&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_ordered_covering_compression</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;PairCompressor&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_pair_compressor</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;PairOnChipRouterCompression&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_pair_compression</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;PairUnorderedCompressor&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_pair_unordered_compressor</span><span class="p">()</span>

        <span class="c1"># delay compression until later</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_do_delayed_compression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">compressed</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run compression that must be delayed until later.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This method is the entry point for adding a new compressor that</span>
<span class="sd">            can not run at the normal place</span>

<span class="sd">        :param str name: Name of a compressor</span>
<span class="sd">        :return: CompressedRoutingTables (likely to be `None`),</span>
<span class="sd">            RouterCompressorProvenanceItems (may be an empty list)</span>
<span class="sd">        :rtype: tuple(~pacman.model.routing_tables.MulticastRoutingTables</span>
<span class="sd">            or None, list(ProvenanceDataItem))</span>
<span class="sd">        :raise ConfigurationException: if the name is not expected</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="ow">or</span> <span class="n">compressed</span><span class="p">:</span>
            <span class="c1"># Already compressed</span>
            <span class="k">return</span> <span class="n">compressed</span>
        <span class="c1"># overridden in spy to handle:</span>
        <span class="c1"># SpynnakerMachineBitFieldOrderedCoveringCompressor</span>
        <span class="c1"># SpynnakerMachineBitFieldPairRouterCompressor</span>

        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;HostBasedBitFieldRouterCompressor&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute_host_bitfield_compressor</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
                <span class="s2">&quot;Only a single algorithm is supported for compressor&quot;</span><span class="p">)</span>

        <span class="k">raise</span> <span class="n">ConfigurationException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Unexpected cfg setting compressor: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_execute_load_routing_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compressed</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the RoutingTableLoader if required.</span>

<span class="sd">        :param compressed:</span>
<span class="sd">        :type compressed: ~.MulticastRoutingTables or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">compressed</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Routing table loader&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">LOADING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_multicast_routes_loaded</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="n">routing_table_loader</span><span class="p">(</span><span class="n">compressed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_report_uncompressed_routing_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the router report from router tables if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Uncompressed routing table report&quot;</span><span class="p">,</span>
                <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_routing_table_reports&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">router_report_from_router_tables</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_report_bit_field_compressor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the BitFieldCompressorReport if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Bitfield compressor report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span>  <span class="s2">&quot;write_bit_field_compressor_report&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="c1"># BitFieldSummary output ignored as never used</span>
            <span class="n">bitfield_compressor_report</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_load_fixed_routes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs Load Fixed Routes if required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Load fixed routes&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">LOADING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;enable_advanced_monitor_support&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="n">load_fixed_routes</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_system_data_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the execute_system_data_specs if required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Execute system data specification&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">execute_system_data_specs</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_load_system_executable_images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the loading of executable images.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Load executable system Images&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">LOADING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="n">load_sys_images</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_application_data_specification</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs :py:meth:`execute_application_data_specs`</span>
<span class="sd">        if required.</span>

<span class="sd">        :return: map of placement and DSG data, and loaded data flag.</span>
<span class="sd">        :rtype: dict(tuple(int,int,int),DataWritten) or DsWriteInfo</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Host data specification&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">LOADING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="k">return</span> <span class="n">execute_application_data_specs</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_tags_from_machine_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Run, times and logs the TagsFromMachineReport if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Tags from machine report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">EXTRACTING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_tag_allocation_reports&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">tags_from_machine_report</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_load_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the Tags Loader if required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO why: if graph_changed or data_changed:</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Tags Loader&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">LOADING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="n">tags_loader</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_do_extra_load_algorithms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs any extra load algorithms.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_report_memory_on_host</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs MemoryMapOnHostReport if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Memory report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_memory_map_report&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">memory_map_on_host_report</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_report_memory_on_chip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs MemoryMapOnHostChipReport if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Memory report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_memory_map_report&quot;</span><span class="p">):</span>
                <span class="k">return</span>

            <span class="n">memory_map_on_host_chip_report</span><span class="p">()</span>

    <span class="c1"># TODO consider different cfg flags</span>
    <span class="k">def</span> <span class="nf">_report_compressed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compressed</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the compressor reports if requested.</span>

<span class="sd">        :param compressed:</span>
<span class="sd">        :type compressed: ~.MulticastRoutingTables or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Compressor report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_routing_table_reports&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_routing_tables_from_machine_reports&quot;</span><span class="p">):</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="n">compressed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                    <span class="k">return</span>
                <span class="n">compressed</span> <span class="o">=</span> <span class="n">read_routing_tables_from_machine</span><span class="p">()</span>

            <span class="n">router_report_from_compressed_router_tables</span><span class="p">(</span><span class="n">compressed</span><span class="p">)</span>

            <span class="n">generate_comparison_router_report</span><span class="p">(</span><span class="n">compressed</span><span class="p">)</span>

            <span class="n">router_compressed_summary_report</span><span class="p">(</span><span class="n">compressed</span><span class="p">)</span>

            <span class="n">routing_table_from_machine_report</span><span class="p">(</span><span class="n">compressed</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_report_fixed_routes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the FixedRouteFromMachineReport if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Fixed route report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;enable_advanced_monitor_support&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="c1"># TODO at the same time as LoadFixedRoutes?</span>
            <span class="n">fixed_route_from_machine_report</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_application_load_executables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Algorithms needed for loading the binaries to the SpiNNaker machine.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Load executable app images&quot;</span><span class="p">,</span>
                      <span class="n">TimerWork</span><span class="o">.</span><span class="n">LOADING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="n">load_app_images</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_do_load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the load algorithms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">start_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">LOADING</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_requires_mapping</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_execute_routing_setup</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_execute_graph_binary_gatherer</span><span class="p">()</span>
        <span class="c1"># loading_algorithms</span>
        <span class="n">compressor</span><span class="p">,</span> <span class="n">pre_compress</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compressor_name</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_pre_compression</span><span class="p">(</span><span class="n">pre_compress</span><span class="p">)</span>
        <span class="n">compressed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_early_compression</span><span class="p">(</span><span class="n">compressor</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_do_data_generation</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_control_sync</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_requires_mapping</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_execute_load_fixed_routes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_system_data_specification</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_load_system_executable_images</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_load_tags</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_application_data_specification</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_do_extra_load_algorithms</span><span class="p">()</span>
        <span class="n">compressed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_delayed_compression</span><span class="p">(</span><span class="n">compressor</span><span class="p">,</span> <span class="n">compressed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_load_routing_tables</span><span class="p">(</span><span class="n">compressed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_report_bit_field_compressor</span><span class="p">()</span>

        <span class="c1"># TODO Was master correct to run the report first?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_tags_from_machine_report</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_requires_mapping</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_report_memory_on_host</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_report_memory_on_chip</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_report_compressed</span><span class="p">(</span><span class="n">compressed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_report_fixed_routes</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_application_load_executables</span><span class="p">()</span>

        <span class="n">FecTimer</span><span class="o">.</span><span class="n">end_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">LOADING</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_report_sdram_usage_per_chip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO why in do run</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Sdram usage per chip report&quot;</span><span class="p">,</span>
                      <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_sdram_usage_report_per_chip&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">sdram_usage_report_per_chip</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_dsg_region_reloader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the DSGRegionReloader if required.</span>

<span class="sd">        Reload any parameters over the loaded data if we have already</span>
<span class="sd">        run and not using a virtual board and the data hasn&#39;t already</span>
<span class="sd">        been regenerated</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_ran_ever</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_hard_reset</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;DSG region reloader&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">LOADING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="n">reload_dsg_regions</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_graph_provenance_gatherer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and log the GraphProvenanceGatherer if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Graph provenance gatherer&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;read_provenance_data&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="n">graph_provenance_gatherer</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_placements_provenance_gatherer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and log the PlacementsProvenanceGatherer if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Placements provenance gatherer&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;read_provenance_data&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="c1"># Also used in recover from error where is is not all placements</span>

            <span class="n">placements_provenance_gatherer</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_n_placements</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">iterate_placemements</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_execute_router_provenance_gatherer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and log the RouterProvenanceGatherer if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span>
                <span class="s2">&quot;Router provenance gatherer&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">EXTRACTING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;read_provenance_data&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="n">router_provenance_gatherer</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_profile_data_gatherer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the ProfileDataGatherer if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Profile data gatherer&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">EXTRACTING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;read_provenance_data&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="n">profile_data_gatherer</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_do_read_provenance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and log the methods that gather provenance.</span>

<span class="sd">        :rtype: list(ProvenanceDataItem)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_graph_provenance_gatherer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_placements_provenance_gatherer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_router_provenance_gatherer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_profile_data_gatherer</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_report_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the energy report if requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Energy report&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">REPORT</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_energy_report&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">[]</span>

            <span class="c1"># TODO runtime is None</span>
            <span class="n">power_used</span> <span class="o">=</span> <span class="n">compute_energy_used</span><span class="p">()</span>

            <span class="n">energy_provenance_reporter</span><span class="p">(</span><span class="n">power_used</span><span class="p">)</span>

            <span class="c1"># create energy reporter</span>
            <span class="n">energy_reporter</span> <span class="o">=</span> <span class="n">EnergyReport</span><span class="p">()</span>

            <span class="c1"># run energy report</span>
            <span class="n">energy_reporter</span><span class="o">.</span><span class="n">write_energy_report</span><span class="p">(</span><span class="n">power_used</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_do_provenance_reports</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs any reports based on provenance.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_execute_clear_io_buf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the ChipIOBufClearer if required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_current_run_timesteps</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Clear IO buffer&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="c1"># TODO Why check empty_graph is always false??</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;clear_iobuf_during_run&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">chip_io_buf_clearer</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_runtime_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_sync_steps</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the runtime updater if required.</span>

<span class="sd">        :param int n_sync_steps:</span>
<span class="sd">            The number of timesteps between synchronisations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Runtime Update&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">LOADING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ExecutableType</span><span class="o">.</span><span class="n">USES_SIMULATION_INTERFACE</span> <span class="ow">in</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_executable_types</span><span class="p">()):</span>
                <span class="n">chip_runtime_updater</span><span class="p">(</span><span class="n">n_sync_steps</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">timer</span><span class="o">.</span><span class="n">skip</span><span class="p">(</span><span class="s2">&quot;No Simulation Interface used&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_execute_create_database_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs Database Interface Creator.</span>

<span class="sd">        Sets the _database_file_path data object</span>

<span class="sd">        :param int run_time: the run duration in milliseconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Create database interface&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="c1"># Used to used compressed routing tables if available on host</span>
            <span class="c1"># TODO consider not saving router tabes.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_database_file_path</span><span class="p">(</span>
                <span class="n">database_interface</span><span class="p">(</span><span class="n">run_time</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_execute_create_notifiaction_protocol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the creation of the Notification Protocol.</span>

<span class="sd">        Sets the notification_interface data object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Create notification protocol&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">OTHER</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_notification_protocol</span><span class="p">(</span>
                <span class="n">create_notification_protocol</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_execute_runner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_sync_steps</span><span class="p">,</span> <span class="n">run_time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the ApplicationRunner.</span>

<span class="sd">        :param int n_sync_steps:</span>
<span class="sd">            The number of timesteps between synchronisations</span>
<span class="sd">        :param int run_time: the run duration in milliseconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="n">FecTimer</span><span class="o">.</span><span class="n">APPLICATION_RUNNER</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">RUNNING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="c1"># Don&#39;t timeout if a stepped mode is in operation</span>
            <span class="k">if</span> <span class="n">n_sync_steps</span><span class="p">:</span>
                <span class="n">time_threshold</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">time_threshold</span> <span class="o">=</span> <span class="n">get_config_int</span><span class="p">(</span>
                    <span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;post_simulation_overrun_before_error&quot;</span><span class="p">)</span>
            <span class="n">application_runner</span><span class="p">(</span>
                <span class="n">run_time</span><span class="p">,</span> <span class="n">time_threshold</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_until_complete</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_execute_extract_iobuff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the ChipIOBufExtractor if required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Extract IO buff&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">EXTRACTING</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_cfg_false</span><span class="p">(</span>
                    <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;extract_iobuf&quot;</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="c1"># ErrorMessages, WarnMessages output ignored as never used!</span>
            <span class="n">chip_io_buf_extractor</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_execute_buffer_extractor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the BufferExtractor if required.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Buffer extractor&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">EXTRACT_DATA</span><span class="p">)</span> <span class="k">as</span> <span class="n">timer</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">skip_if_virtual_board</span><span class="p">():</span>
                <span class="k">return</span>
            <span class="n">bm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_buffer_manager</span><span class="p">()</span>
            <span class="n">bm</span><span class="o">.</span><span class="n">get_placement_data</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_do_extract_from_machine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the steps to extract data from the machine.</span>

<span class="sd">        :param run_time: the run duration in milliseconds.</span>
<span class="sd">        :type run_time: int or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_extract_iobuff</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_buffer_extractor</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_clear_io_buf</span><span class="p">()</span>

        <span class="c1"># FinaliseTimingData never needed as just pushed self._ to inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_read_provenance</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_report_energy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_provenance_reports</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__do_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_machine_time_steps</span><span class="p">,</span> <span class="n">n_sync_steps</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the do run steps.</span>

<span class="sd">        :param n_machine_time_steps: Number of timesteps run</span>
<span class="sd">        :type n_machine_time_steps: int or None</span>
<span class="sd">        :param int n_sync_steps:</span>
<span class="sd">            The number of timesteps between synchronisations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO virtual board</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">start_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">RUN_LOOP</span><span class="p">)</span>
        <span class="n">run_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">n_machine_time_steps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">run_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_machine_time_steps</span> <span class="o">*</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_simulation_time_step_ms</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">increment_current_run_timesteps</span><span class="p">(</span>
            <span class="n">n_machine_time_steps</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_report_sdram_usage_per_chip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_report_drift</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_requires_mapping</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_execute_create_database_interface</span><span class="p">(</span><span class="n">run_time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_create_notifiaction_protocol</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_ran_ever</span><span class="p">()</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_requires_mapping</span><span class="p">()</span> <span class="ow">and</span>
                <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_requires_data_generation</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_execute_dsg_region_reloader</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_runtime_update</span><span class="p">(</span><span class="n">n_sync_steps</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_runner</span><span class="p">(</span><span class="n">n_sync_steps</span><span class="p">,</span> <span class="n">run_time</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_machine_time_steps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_until_complete</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_do_extract_from_machine</span><span class="p">()</span>
        <span class="c1"># reset at the end of each do_run cycle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_report_drift</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_control_sync</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">end_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">RUN_LOOP</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_do_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_machine_time_steps</span><span class="p">,</span> <span class="n">n_sync_steps</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs, times and logs the do run steps.</span>

<span class="sd">        :param n_machine_time_steps: Number of timesteps run</span>
<span class="sd">        :type n_machine_time_steps: int or None</span>
<span class="sd">        :param int n_sync_steps:</span>
<span class="sd">            The number of timesteps between synchronisations</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__do_run</span><span class="p">(</span><span class="n">n_machine_time_steps</span><span class="p">,</span> <span class="n">n_sync_steps</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;User has aborted the simulation&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown</span><span class="p">()</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">run_e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_recover_from_error</span><span class="p">(</span><span class="n">run_e</span><span class="p">)</span>

            <span class="c1"># reraise exception</span>
            <span class="k">raise</span> <span class="n">run_e</span>

    <span class="k">def</span> <span class="nf">_recover_from_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param Exception exception:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__recover_from_error</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">rec_e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Error </span><span class="si">{</span><span class="n">rec_e</span><span class="si">}</span><span class="s2"> when attempting to recover from error&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__recover_from_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param Exception exception:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if exception has an exception, print to system</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;An error has occurred during simulation&quot;</span><span class="p">)</span>
        <span class="c1"># Print the detail including the traceback</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">exception</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Attempting to extract data</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Extract router provenance</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">router_provenance_gatherer</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Error reading router provenance&quot;</span><span class="p">)</span>

        <span class="c1"># Find the cores that are not in an expected state</span>
        <span class="n">unsuccessful_cores</span> <span class="o">=</span> <span class="n">CPUInfos</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exception</span><span class="p">,</span> <span class="n">SpiNNManCoresNotInStateException</span><span class="p">):</span>
            <span class="n">unsuccessful_cores</span> <span class="o">=</span> <span class="n">exception</span><span class="o">.</span><span class="n">failed_core_states</span><span class="p">()</span>

        <span class="c1"># If there are no cores in a bad state, find those not yet in</span>
        <span class="c1"># their finished state</span>
        <span class="n">transceiver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_transceiver</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">unsuccessful_cores</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">executable_type</span><span class="p">,</span> <span class="n">core_subsets</span> <span class="ow">in</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_executable_types</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">failed_cores</span> <span class="o">=</span> <span class="n">transceiver</span><span class="o">.</span><span class="n">get_cores_not_in_state</span><span class="p">(</span>
                    <span class="n">core_subsets</span><span class="p">,</span> <span class="n">executable_type</span><span class="o">.</span><span class="n">end_state</span><span class="p">)</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="n">failed_cores</span><span class="p">:</span>
                    <span class="n">unsuccessful_cores</span><span class="o">.</span><span class="n">add_processor</span><span class="p">(</span>
                        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">failed_cores</span><span class="o">.</span><span class="n">get_cpu_info</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>

        <span class="c1"># Print the details of error cores</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">transceiver</span><span class="o">.</span><span class="n">get_core_status_string</span><span class="p">(</span><span class="n">unsuccessful_cores</span><span class="p">))</span>

        <span class="c1"># Find the cores that are not in RTE i.e. that can still be read</span>
        <span class="n">non_rte_cores</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span> <span class="n">core_info</span> <span class="ow">in</span> <span class="n">unsuccessful_cores</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">core_info</span><span class="o">.</span><span class="n">state</span> <span class="o">!=</span> <span class="n">CPUState</span><span class="o">.</span><span class="n">RUN_TIME_EXCEPTION</span> <span class="ow">and</span>
                <span class="n">core_info</span><span class="o">.</span><span class="n">state</span> <span class="o">!=</span> <span class="n">CPUState</span><span class="o">.</span><span class="n">WATCHDOG</span><span class="p">)]</span>

        <span class="c1"># If there are any cores that are not in RTE, extract data from them</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">non_rte_cores</span> <span class="ow">and</span>
                <span class="n">ExecutableType</span><span class="o">.</span><span class="n">USES_SIMULATION_INTERFACE</span> <span class="ow">in</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_executable_types</span><span class="p">()):</span>
            <span class="n">non_rte_core_subsets</span> <span class="o">=</span> <span class="n">CoreSubsets</span><span class="p">()</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="n">non_rte_cores</span><span class="p">:</span>
                <span class="n">non_rte_core_subsets</span><span class="o">.</span><span class="n">add_processor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

            <span class="c1"># Attempt to force the cores to write provenance and exit</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">chip_provenance_updater</span><span class="p">(</span><span class="n">non_rte_core_subsets</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Could not update provenance on chip&quot;</span><span class="p">)</span>

            <span class="c1"># Extract any written provenance data</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">transceiver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_transceiver</span><span class="p">()</span>
                <span class="n">finished_cores</span> <span class="o">=</span> <span class="n">transceiver</span><span class="o">.</span><span class="n">get_cores_in_state</span><span class="p">(</span>
                    <span class="n">non_rte_core_subsets</span><span class="p">,</span> <span class="n">CPUState</span><span class="o">.</span><span class="n">FINISHED</span><span class="p">)</span>
                <span class="n">finished_placements</span> <span class="o">=</span> <span class="n">Placements</span><span class="p">()</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="n">finished_cores</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">placement</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span>\
                            <span class="n">get_placement_on_processor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
                        <span class="n">finished_placements</span><span class="o">.</span><span class="n">add_placement</span><span class="p">(</span><span class="n">placement</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>   <span class="c1"># pylint: disable=broad-except</span>
                        <span class="k">pass</span>  <span class="c1"># already recovering from error</span>
                <span class="n">placements_provenance_gatherer</span><span class="p">(</span>
                    <span class="n">finished_placements</span><span class="o">.</span><span class="n">n_placements</span><span class="p">,</span>
                    <span class="n">finished_placements</span><span class="o">.</span><span class="n">placements</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">pro_e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not read provenance due to </span><span class="si">{</span><span class="n">pro_e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Read IOBUF where possible (that should be everywhere)</span>
        <span class="n">iobuf</span> <span class="o">=</span> <span class="n">IOBufExtractor</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="n">iobuf</span><span class="o">.</span><span class="n">extract_iobuf</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Could not get iobuf&quot;</span><span class="p">)</span>
            <span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

        <span class="c1"># Print the IOBUFs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_iobuf</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_print_iobuf</span><span class="p">(</span><span class="n">errors</span><span class="p">,</span> <span class="n">warnings</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param list(str) errors:</span>
<span class="sd">        :param list(str) warnings:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">warning</span> <span class="ow">in</span> <span class="n">warnings</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">warning</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">errors</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<div class="viewcode-block" id="AbstractSpinnakerBase.reset"><a class="viewcode-back" href="../../../spinn_front_end_common.interface.html#spinn_front_end_common.interface.abstract_spinnaker_base.AbstractSpinnakerBase.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Puts the simulation back at time zero.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">start_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">RESETTING</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_ran_last</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_ran_ever</span><span class="p">():</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Ignoring the reset before the run&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Ignoring the repeated reset call&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Resetting&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_user_accessed_machine</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;A reset after a get machine call is always hard and &quot;</span>
                <span class="s2">&quot;therefore the previous machine is no longer valid&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hard_reset</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">soft_reset</span><span class="p">()</span>

        <span class="c1"># rewind the buffers from the buffer manager, to start at the beginning</span>
        <span class="c1"># of the simulation again and clear buffered out</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">has_buffer_manager</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_buffer_manager</span><span class="p">()</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

        <span class="c1"># Reset the graph off the machine, to set things to time 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__reset_graph_elements</span><span class="p">()</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">end_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">RESETTING</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">has_ipaddress</span><span class="p">():</span>
            <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;general front end instance for machine &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_ipaddress</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;general front end instance no machine set&quot;</span>

    <span class="k">def</span> <span class="nf">_shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># if stopping on machine, clear IP tags and routing table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__clear</span><span class="p">()</span>

        <span class="c1"># stop the transceiver and allocation controller</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">has_transceiver</span><span class="p">():</span>
            <span class="n">transceiver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_transceiver</span><span class="p">()</span>
            <span class="n">transceiver</span><span class="o">.</span><span class="n">stop_application</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_app_id</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__close_allocation_controller</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">clear_notification_protocol</span><span class="p">()</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">stop_category_timing</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">shut_down</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">has_transceiver</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="n">transceiver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_transceiver</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;clear_tags&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">ip_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span><span class="o">.</span><span class="n">ip_tags</span><span class="p">:</span>
                <span class="n">transceiver</span><span class="o">.</span><span class="n">clear_ip_tag</span><span class="p">(</span>
                    <span class="n">ip_tag</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="n">board_address</span><span class="o">=</span><span class="n">ip_tag</span><span class="o">.</span><span class="n">board_address</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">reverse_ip_tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_tags</span><span class="p">()</span><span class="o">.</span><span class="n">reverse_ip_tags</span><span class="p">:</span>
                <span class="n">transceiver</span><span class="o">.</span><span class="n">clear_ip_tag</span><span class="p">(</span>
                    <span class="n">reverse_ip_tag</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span>
                    <span class="n">board_address</span><span class="o">=</span><span class="n">reverse_ip_tag</span><span class="o">.</span><span class="n">board_address</span><span class="p">)</span>

        <span class="c1"># if clearing routing table entries, clear</span>
        <span class="k">if</span> <span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;clear_routing_tables&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">router_table</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_uncompressed</span><span class="p">():</span>
                <span class="n">transceiver</span><span class="o">.</span><span class="n">clear_multicast_routes</span><span class="p">(</span>
                    <span class="n">router_table</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">router_table</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__close_allocation_controller</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">FecDataView</span><span class="o">.</span><span class="n">has_allocation_controller</span><span class="p">():</span>
            <span class="n">FecDataView</span><span class="o">.</span><span class="n">get_allocation_controller</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">set_allocation_controller</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<div class="viewcode-block" id="AbstractSpinnakerBase.stop"><a class="viewcode-back" href="../../../spinn_front_end_common.interface.html#spinn_front_end_common.interface.abstract_spinnaker_base.AbstractSpinnakerBase.stop">[docs]</a>    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        End running of the simulation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">stopping</span><span class="p">()</span>
        <span class="n">FecTimer</span><span class="o">.</span><span class="n">start_category</span><span class="p">(</span><span class="n">TimerCategory</span><span class="o">.</span><span class="n">SHUTTING_DOWN</span><span class="p">)</span>
        <span class="c1"># If we have run forever, stop the binaries</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_ran_ever</span><span class="p">()</span>
                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_current_run_timesteps</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="ow">not</span> <span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;virtual_board&quot;</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_until_complete</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_do_stop_workflow</span><span class="p">()</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;read_provenance_data_on_end&quot;</span><span class="p">)</span> <span class="ow">and</span>
                  <span class="ow">not</span> <span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;read_provenance_data&quot;</span><span class="p">)):</span>
                <span class="n">set_config</span><span class="p">(</span><span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;read_provenance_data&quot;</span><span class="p">,</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_do_read_provenance</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_recover_from_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_errored_file</span><span class="p">()</span>
            <span class="k">raise</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="c1"># shut down the machine properly</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write_finished_file</span><span class="p">()</span></div>
        <span class="c1"># No matching FecTimer.end_category as shutdown stops timer</span>

    <span class="k">def</span> <span class="nf">_execute_application_finisher</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">FecTimer</span><span class="p">(</span><span class="s2">&quot;Application finisher&quot;</span><span class="p">,</span> <span class="n">TimerWork</span><span class="o">.</span><span class="n">CONTROL</span><span class="p">):</span>
            <span class="n">application_finisher</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_do_stop_workflow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execute_application_finisher</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_do_extract_from_machine</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">get_number_of_available_cores_on_machine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The number of available cores on the machine after taking</span>
<span class="sd">        into account preallocated resources.</span>

<span class="sd">        :return: number of available cores</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">machine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_machine</span><span class="p">()</span>
        <span class="c1"># get cores of machine</span>
        <span class="n">cores</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">total_available_user_cores</span>
        <span class="n">take_into_account_chip_power_monitor</span> <span class="o">=</span> <span class="n">get_config_bool</span><span class="p">(</span>
            <span class="s2">&quot;Reports&quot;</span><span class="p">,</span> <span class="s2">&quot;write_energy_report&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">take_into_account_chip_power_monitor</span><span class="p">:</span>
            <span class="n">cores</span> <span class="o">-=</span> <span class="n">machine</span><span class="o">.</span><span class="n">n_chips</span>
        <span class="n">take_into_account_extra_monitor_cores</span> <span class="o">=</span> <span class="p">(</span><span class="n">get_config_bool</span><span class="p">(</span>
            <span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;enable_advanced_monitor_support&quot;</span><span class="p">)</span> <span class="ow">or</span>
                <span class="n">get_config_bool</span><span class="p">(</span><span class="s2">&quot;Machine&quot;</span><span class="p">,</span> <span class="s2">&quot;enable_reinjection&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">take_into_account_extra_monitor_cores</span><span class="p">:</span>
            <span class="n">cores</span> <span class="o">-=</span> <span class="n">machine</span><span class="o">.</span><span class="n">n_chips</span>
            <span class="n">cores</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">machine</span><span class="o">.</span><span class="n">ethernet_connected_chips</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cores</span>

<div class="viewcode-block" id="AbstractSpinnakerBase.stop_run"><a class="viewcode-back" href="../../../spinn_front_end_common.interface.html#spinn_front_end_common.interface.abstract_spinnaker_base.AbstractSpinnakerBase.stop_run">[docs]</a>    <span class="k">def</span> <span class="nf">stop_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Request that the current infinite run stop.</span>

<span class="sd">        .. note::</span>
<span class="sd">            This will need to be called from another thread as the infinite</span>
<span class="sd">            run call is blocking.</span>

<span class="sd">        :raises SpiNNUtilsException:</span>
<span class="sd">            If the stop_run was not expected in the current state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Do not do start category here</span>
        <span class="c1"># as called from a different thread while running</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">is_stop_already_requested</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;Second Request to stop_run ignored&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_condition</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">request_stop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_state_condition</span><span class="o">.</span><span class="n">notify_all</span><span class="p">()</span></div>

<div class="viewcode-block" id="AbstractSpinnakerBase.continue_simulation"><a class="viewcode-back" href="../../../spinn_front_end_common.interface.html#spinn_front_end_common.interface.abstract_spinnaker_base.AbstractSpinnakerBase.continue_simulation">[docs]</a>    <span class="k">def</span> <span class="nf">continue_simulation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Continue a simulation that has been started in stepped mode.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sync_signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_next_sync_signal</span><span class="p">()</span>
        <span class="n">transceiver</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_transceiver</span><span class="p">()</span>
        <span class="n">transceiver</span><span class="o">.</span><span class="n">send_signal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">get_app_id</span><span class="p">(),</span> <span class="n">sync_signal</span><span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__reset_object</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="c1"># Reset an object if appropriate</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">AbstractCanReset</span><span class="p">):</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">reset_to_first_timestep</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__reset_graph_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Reset any object that can reset</span>
        <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">iterate_vertices</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__reset_object</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_writer</span><span class="o">.</span><span class="n">iterate_partitions</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__reset_object</span><span class="p">(</span><span class="n">edge</span><span class="p">)</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">SpiNNFrontEndCommon 1!7.0.0-a1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">spinn_front_end_common.interface.abstract_spinnaker_base</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.0.
    </div>
  </body>
</html>